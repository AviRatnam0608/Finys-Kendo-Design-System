<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ui Mockups</title>
  <link href="https://kendo.cdn.telerik.com/themes/8.2.1/default/default-main.css" rel="stylesheet" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="/kendo.all.min.js"></script>
  <script src="/kendo-ui-jquery-license.js"></script>
  <script defer type="module" src="../main.js"></script>

  <script src="./finys-binders.js"></script>
  <!-- ComponentStyles -->
  <link rel="stylesheet" type="text/css"
    href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.1/src/regular/style.css" />
  <link rel="stylesheet" type="text/css"
    href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.1/src/fill/style.css" />
  <link rel="stylesheet" type="text/css"
    href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.1/src/light/style.css" />
  <link rel="stylesheet" href="../styles/components/stepper.css">
  <style>
    /* transient styles */
    .my-dropdown {
      max-width: 200px;
    }

    .templated-dropdown,
    .timepicker {
      max-width: 300px;
    }

    .container,
    section {
      max-width: 80%;
      margin: 1rem auto;
      gap: 2rem;
    }
  </style>
</head>

<body style="padding-bottom: 25rem;">
  <section>
    <h1>Dropdown</h1>
    <div id="dropdowns-container" class="container">
      <input is="finys-dropdown-list" class="my-dropdown" data-text-field="name" data-bind="value: basicDropdownValue,
                            source: listData, 
                            isSelected: basicDropdownValue" />

      <input is="finys-dropdown-list" class="my-dropdown" data-text-field="name" data-bind="value: groupDropdownValue,
                            source: groupListData, 
                            isSelected: groupDropdownValue" />

      <input is="finys-detailed-dropdown-list" class="templated-dropdown" data-text-field="AgentName"
        data-value-field="AgentCode" data-detail-left="AgencyCode" data-detail-right="AgencyName"
        data-detail-bottom="Address" data-bind="
              value: templatedDropdownValue, 
              source: templatedListData, 
              isSelected: templatedDropdownValue" />
    </div>
  </section>
  <hr />

  <section>
    <h1>Time Picker</h1>
    <div style="width: 15rem">
      <input id="my-timepicker" is="finys-timepicker" class="" data-bind="value: time, timepickerIsSelected: time" />
      <finys-validation>this is a validation with a very long error message that should get cut off</finys-validation>
    </div>
  </section>

  <section>
    <h1>Text Editor</h1>
    <textarea class="f-editor" data-role="editor" data-tools="[
            [
              'bold',
              'italic',
              'underline'
            ],
            [
              'justifyLeft',
              'justifyCenter',
              'justifyRight',
              'justifyFull'
            ],
            {
              name: 'copy',
              template: function() {
                return '<button class=\'f-button f-clickable\'><div class=\'f-button-content\'><i class=\'ph ph-copy\'></i><span>Insert</span></div></button>'
              }
            },
            {
              name: 'cut',
              template: function() {
                return '<button class=\'f-button f-clickable\'><div class=\'f-button-content\'><i class=\'ph ph-scissors\'></i><span>Cut</span></div></button>'
              }
            },
            {
              name: 'insert',
              template: function() {
                return '<button class=\'f-button f-clickable\'><div class=\'f-button-content\'><i class=\'ph ph-copy\'></i><span>Copy</span></div></button>'
              }
            },
            {
              name: 'Paste',
              template: function() {
                return '<button class=\'f-button f-clickable\'><div class=\'f-button-content\'><i class=\'ph ph-clipboard-text\'></i><span>Paste</span></div></button>'
              }
            }

          ]"></textarea>
  </section>
  <hr />

  <section>
    <h1>Toggle</h1>
    <div class="container">
      <input class="f-toggle-switch f-toggle-switch-large" data-role="switch"
        data-bind="enabled: isEnabled, visible: isVisible, checked: isChecked, events: { change: onChange }, disabled: isDisabled" />
      <label class="f-text-regular">Some text</label>
    </div>
    <div class="container">
      <input class="f-toggle-switch f-toggle-switch-medium" data-role="switch"
        data-bind="enabled: isEnabled, visible: isVisible, checked: isChecked, events: { change: onChange }, disabled: isDisabled" />
      <label class="f-text-small">Some text</label>
    </div>
    <div class="container">
      <input class="f-toggle-switch f-toggle-switch-small" data-role="switch"
        data-bind="enabled: isEnabled, visible: isVisible, checked: isChecked, events: { change: onChange }, disabled: isDisabled" />
      <label class="f-text-tiny">Some text</label>
    </div>
  </section>
  <hr />

  <section>
    <h1>Modal</h1>
    <div class="container">
      <button data-bind="click: showModalLarge">Show Large Modal</button>
      <button data-bind="click: showModalMedium">Show Medium Modal</button>
      <button data-bind="click: showModalSmall">Show Small Modal</button>
    </div>
  </section>
  <hr />

  <section id="finys-text-input-container">
    <h1>Text inputs</h1>


    <div class="input-container">

      <input data-label="Name" is="finys-text-box" />
    </div>

    <div class="input-container">

      <input disabled data-label="Name Disabled" is="finys-text-box" />
    </div>

    
    <div class="input-container">

      <input readonly data-label="Name read only" value="test" label is="finys-text-box" />
    </div>

    <div class="input-container">

      <input data-label="Name" name="username" required class="k-invalid" is="finys-text-box"  />
    </div>

    <div class="input-container">

      <input data-label="Phone #" data-mask="(999) 000-0000" placeholder="(___) ___-____"  is="finys-masked-text-box" />
    </div>
    
  </section>

  <hr />
  <section>
    <h1>Buttons</h1>
    <div class="section">
      <button is="finys-button" data-bind="click: testClick">Action</button>
      <h3>Primary</h3>
      <button is="finys-button" class="f-button-primary f-button-large" data-bind="click: testClick">
        Action
      </button>
      <button is="finys-button" class="f-button-primary f-button-medium" data-bind="click: testClick">
        Action
      </button>
      <button is="finys-button" class="f-button-primary f-button-medium" data-bind="click: testClick">
        Action
      </button>

      <button is="finys-button" class="f-button-primary f-button-xsmall" data-bind="click: testClick">

        <i class="ph ph-cheers" style="font-size: 0.75rem"></i>

      </button>

      <h3>Secondary</h3>
      <button is="finys-button" class="f-button-secondary f-button-large" data-bind="click: testClick">
        Action
      </button>
      <button is="finys-button" class="f-button-secondary f-button-medium" data-bind="click: testClick">
        Action
      </button>
      <button is="finys-button" class="f-button-secondary f-button-medium" data-bind="click: testClick">
        Action
      </button>

      <button is="finys-button" class="f-button-secondary f-button-xsmall" data-bind="click: testClick">

        <i class="ph ph-cheers" style="font-size: 0.75rem"></i>

      </button>

      <h3>Tertiary</h3>
      <button is="finys-button" class="f-button-tertiary f-button-large" data-bind="click: testClick">
        Action
      </button>
      <button is="finys-button" class="f-button-tertiary f-button-medium" data-bind="click: testClick">
        Action
      </button>
      <button is="finys-button" class="f-button-tertiary f-button-medium" data-bind="click: testClick">
        Action
      </button>

      <button is="finys-button" class="f-button-tertiary f-button-xsmall" data-bind="click: testClick">

        <i class="ph ph-cheers" style="font-size: 0.75rem"></i>

      </button>

      <h3>Destructive</h3>
      <button is="finys-button" class="f-button-destructive f-button-large" data-bind="click: testClick">
        Action
      </button>
      <button is="finys-button" class="f-button-destructive f-button-medium" data-bind="click: testClick">
        Action
      </button>
      <button is="finys-button" class="f-button-destructive f-button-medium" data-bind="click: testClick">
        Action
      </button>

      <button is="finys-button" class="f-button-destructive f-button-xsmall" data-bind="click: testClick">
        <i class="ph ph-cheers" style="font-size: 0.75rem"></i>
      </button>
    </div>
  </section>

  <hr />
  <section id="date-picker-section">
    <h1>Date Picker</h1>
    <div class="section">
      <input id="datepicker" title="datetimepicker" />
    </div>
  </section>

  <hr/>
  <section>
    <h1>Checkboxes</h1>
    <input is="finys-checkbox" id="checkbox-1" data-label ="Text here" style="font-size: 16px ;"/>
    <input is="finys-checkbox" id="checkbox-2" data-label ="Text here" style="font-size: 14px ;"/>
    <input is="finys-checkbox" id="checkbox-3" data-label ="Text here" style="font-size: 12px ;"/>
  </section>

  <hr/>
  <section>
    <h1>Radio Button</h1>
    <input is="finys-radiobutton" name="radiobutton" id="radiobutton-1" data-label ="Text here" style="font-size: 16px ;"/>
    <input is="finys-radiobutton" name="radiobutton" id="radiobutton-2" data-label ="Text here" style="font-size: 14px ;"/>
    <input is="finys-radiobutton" name="radiobutton" id="radiobutton-3" data-label ="Text here" style="font-size: 12px ;"/>
  </section>

  <hr/>
  <section style="padding-bottom: 100px">
  <section>
    <h1>Wizard</h1>
    <finys-progress-stepper
      id="my-wizard"
      steps='[
        {"label":"1. Step One","selected":true},
        {"label":"2. Step Two"},
        {"label":"3. Step Three"},
        {"label":"4. Step Four"}
      ]'
    >
      <div step="1">
        <h1>Step 1</h1>
        <p>
          This will have various controls in it and they need
          to be bound to the main view model.
        </p>
        <button is="finys-button" data-bind="click: testClick">Test Click</button>
        <span data-bind="text: togglingValue"></span>
      </div>
      <div step="2"><h1>Step 2</h1></div>
      <div step="3"><h1>Step 3</h1></div>
      <div step="4"><h1>Step 4</h1></div>
    </finys-progress-stepper>

    <button 
      is="finys-button"
      class="f-primary f-button-large"
      data-bind="click: showWizard"
    >
        Open Wizard
    </button>   
  </section>
</body>

<script type="module">
  import {Modal} from './modals/modal.js';
  import {WizardModal} from './modals/wizard-modal.js';
  $(".f-group-dropdown-input").on("focus", function (e) {
    $(e.currentTarget).next().addClass("f-focus");
  });
  $(".f-group-dropdown-input").on("blur", function (e) {
    $(e.currentTarget).next().removeClass("f-focus");
  });
  
  const vm = kendo.observable({
    togglingValue: false,
    progressValue: "46",
    isChecked: true,
    isEnabled: true,
    isVisible: true,
    isModalLargeVisible: false,
    isModalMediumVisible: false,
    isModalSmallVisible: false,
    isModalEnabled: true,
    isDisabled: false,
    onChange: function (e) {
      console.log(
        "event :: change (" + (e.checked ? "checked" : "unchecked") + ")"
      );
    },
    testClick: function () {
      console.log("test");
      this.set('togglingValue', !this.togglingValue);
    },
    isClosable: true,
    isEnabled: false,
    onClose: function (e) {
      this.set("isModalLargeVisible", false);
      this.set("isModalMediumVisible", false);
      this.set("isModalSmallVisible", false);
      this.set("isModalEnabled", true);
    },
    showWizard: function(e) {
      if(!this.myWizard) {
        this.myWizard = new WizardModal({
          title: 'My Wizard',
          content: {template: () => `
            <finys-progress-stepper
            id="my-wizard-modal"
            steps='[
              {"label":"1. Step One","selected":true},
              {"label":"2. Step Two"},
              {"label":"3. Step Three"},
              {"label":"4. Step Four"}
              ]'
              >
                <div step="1">
                  This is step 1
                  <button 
                    is="finys-button" 
                    class="f-button-primary" 
                    data-bind="click: testClick" 
                  >
                    Test click
                    </button>
                </div>
                <div step="2">
                  Step 2
                </div>
                <div step="3">
                  Step 3
                </div>
                <div step="4">
                  Step 4
                </div>
              </finys-progress-stepper>`}
        })
        this.myWizard.open();
        return kendo.bind($('#my-wizard-modal'), this);
      }
      this.myWizard.open();
    },
    showModalLarge: function (e) {
      if(!this.largeModal) {
        this.largeModal = new Modal({
          title: 'whatever',
          content: {template: () => '<div>this is some content</div>'},
          width: '450px',
          modal: true,
          size: 'large',
        });
      }
      this.largeModal.open();
    },
    showModalMedium: function (e) {
      if(!this.mediumModal) {
        this.mediumModal = new Modal({
          title: 'whatever',
          content: {template: () => '<div>this is some content</div>'},
          width: '450px',
          modal: true,
          size: 'medium',
        });
      }
      this.mediumModal.open();
    },
    showModalSmall: function (e) {
      if(!this.smallModal) {
        this.smallModal = new Modal({
          title: 'whatever',
          content: {template: () => '<div>this is some content</div>'},
          width: '450px',
          modal: true,
          size: 'small',
        });
      }
      this.smallModal.open();
    },
    listData: new kendo.data.DataSource({
      data: [
        {
          id: 1,
          name: "test1",
        },
        {
          id: 2,
          name: "test2",
        },
        {
          id: 3,
          name: "test3",
        },
      ],
    }),
    products: new kendo.data.DataSource({
      data: [
        {
          id: 1,
          name: "test1",
        },
        {
          id: 2,
          name: "test2",
        },
        {
          id: 3,
          name: "test3",
        },
        {
          id: 3,
          name: "test3",
        },
        {
          id: 3,
          name: "test3",
        },
        {
          id: 3,
          name: "test3",
        },
        {
          id: 3,
          name: "test3",
        },
        {
          id: 3,
          name: "test3",
        },
        {
          id: 3,
          name: "test3",
        },
        {
          id: 3,
          name: "test3",
        },
        {
          id: 3,
          name: "test3",
        },
        {
          id: 3,
          name: "test3",
        },
      ],
      pageSize: 10
    }),

    groupListData: new kendo.data.DataSource({
      data: [
        {
          id: 1,
          name: "Apple",
          group: "Eins",
        },
        {
          id: 2,
          name: "Banana",
          group: "Eins",
        },
        {
          id: 3,
          name: "Beef",
          group: "Zwei",
        },
        {
          id: 4,
          name: "Pork",
          group: "Zwei",
        },
        {
          id: 5,
          name: "Poultry",
          group: "Zwei",
        },

        {
          id: 6,
          name: "Water",
          group: "Drei",
        },
        {
          id: 7,
          name: "Water",
          group: "Drei",
        },
        {
          id: 8,
          name: "Water",
          group: "Drei",
        },
        {
          id: 9,
          name: "Water",
          group: "Drei",
        },
        {
          id: 10,
          name: "Water",
          group: "Drei",
        },
        {
          id: 11,
          name: "Water",
          group: "Drei",
        },
      ],
      group: { field: "group" },
    }),
    templatedListData: new kendo.data.DataSource({
      data: [{
        id: 1,
        AgentCode: "AgentCode",
        AgentName: 'AgentName',
        AgencyCode: 'AgencyCode',
        AgencyName: 'AgencyName',
        Address: 'Address'
      },
      {
        id: 2,
        AgentCode: "AgentCode",
        AgentName: 'AgentName',
        AgencyCode: 'AgencyCode',
        AgencyName: 'AgencyName',
        Address: 'Address'
      }
      ],
    }),
    basicDropdownValue: null,
    groupDropdownValue: null,
    templatedDropdownValue: null,
  });

  function onRemind(e) {
    console.log("Action :: Cancel");
  }

  function onInstall(e) {
    console.log("Action :: Action");
  }

  $(document).ready(() => {
    // const obj = new Timepicker({ target: '#dropdowns-container' })
    // console.log(obj);
    kendo.bind($("body"), vm);
    $('.f-generated-template').each((i, element) => {
      kendo.bind($(element), vm)
    })

    $("#finys-text-input-container")
      .kendoValidator()
      .data("kendoValidator")
      .validateInput($("input[name=username]"));


    createFinysDatePicker("datepicker");
  });

  function createFinysDatePicker(id) {
    let callBack = (e) => {
      const datePicker = $(`#${id}`).data("kendoDatePicker");
      const calendar = datePicker.dateView.calendar;
      const calendarElement = calendar.element;

      const minYear = 1900,
        maxYear = 2100;

      const yearList = Array.from(
        { length: maxYear - minYear + 1 },
        (_, i) => minYear + i
      );

      const monthNames = [
        "January",
        "February",
        "March",
        "April",
        "May",
        "June",
        "July",
        "August",
        "September",
        "October",
        "November",
        "December",
      ];

      if (calendarElement.find(".f-calendar-header").length) return;

      let customHeader = $(`
            <div class="f-calendar-header">
              <a class="f-previous-month-arrow"><i class="ph ph-caret-left"></i></a>
              <div class="f-calendar-header-dropdown-group">
                <input class="f-calendar-month-dropdown" />
                <input class="f-calendar-year-dropdown" />

              </div>
              <a class="f-next-month-arrow"><i class="ph ph-caret-right"></i></a>
            </div>
              `);

      //replace with new header
      $(".k-widget.k-calendar.k-calendar-md > .k-header.k-hstack"
      ).replaceWith(customHeader);

      //remove footer
      $(".k-widget.k-calendar.k-calendar-md .k-footer").remove();

      let onMonthChange = (e) => {
        currentMonth = parseInt(e.sender.select() - 1);
        if (isNaN(currentMonth) == false)
          updateCalendar();
      };
      let onYearChange = (e) => {
        currentYear = parseInt(e.sender.value(), 10);
        if (isNaN(currentYear) == false)
          updateCalendar();
      };

      let currentDate = calendar.current();
      let currentMonth = currentDate.getMonth();
      let currentYear = currentDate.getFullYear();

      const monthDropDown = $(".f-calendar-month-dropdown")
        .kendoDropDownList({
          optionLabel: "Select a month",
          dataSource: monthNames,
          value: monthNames[currentMonth],
          change: onMonthChange,
        })
        .data("kendoDropDownList");

      const yearDropDown = $(".f-calendar-year-dropdown")
        .kendoDropDownList({
          optionLabel: "Select a year",
          dataSource: yearList,
          value: currentYear,
          change: onYearChange,
        })
        .data("kendoDropDownList");


      $(".f-calendar-month-dropdown").on("mousedown", e =>
        $(e.target).attr("hasClosed", true)
      );
      $(".f-calendar-year-dropdown").on("mousedown", e =>
        $(e.target).attr("hasClosed", true)
      );



      function updateCalendar() {
        const newDate = new Date(currentYear, currentMonth, 1);
        calendar.navigate(newDate, "month");
      }

      customHeader.find(".f-previous-month-arrow").on("click", () => {
        let newDate = new Date(currentYear, currentMonth - 1, 1);
        currentMonth = newDate.getMonth();
        currentYear = newDate.getFullYear();
        monthDropDown.value(monthNames[currentMonth]);
        yearDropDown.value(currentYear);
        updateCalendar();
      });

      customHeader.find(".f-next-month-arrow").on("click", () => {
        let newDate = new Date(currentYear, currentMonth + 1, 1);
        currentMonth = newDate.getMonth();
        currentYear = newDate.getFullYear();
        monthDropDown.value(monthNames[currentMonth]);
        yearDropDown.value(currentYear);
        updateCalendar();
      });
    };

    let calendar = $(`#${id}`)
      .kendoDatePicker({
        value: new Date(),
        format: "MM/dd/yyyy",
        open: callBack,
        close: (e) => {

          let monthDD = $(".f-calendar-month-dropdown > span  >span.k-input-value-text");
          let yearDD = $(".f-calendar-year-dropdown > span  >span.k-input-value-text");

          if ((monthDD && monthDD.attr("hasClosed") == "true") || (yearDD && yearDD.attr("hasClosed") == "true")) {
            e.preventDefault();
          }
          monthDD.attr("hasClosed", false)
          yearDD.attr("hasClosed", false)

        },
      })
      .data("kendoDatePicker");
    calendar.element.addClass("FinysDatePicker");

    //move calendar button
    let calButton = calendar.element.parent().find("button");
    calButton.prev().insertAfter(calButton)

    //replace with phosphor icon
    calButton.find("span").removeClass().addClass("ph ph-calendar-blank").find("svg").remove();

  }
</script>

</html>